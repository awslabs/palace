<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · Palace</title><meta name="title" content="Reference · Palace"/><meta property="og:title" content="Reference · Palace"/><meta property="twitter:title" content="Reference · Palace"/><meta name="description" content="Documentation for Palace."/><meta property="og:description" content="Documentation for Palace."/><meta property="twitter:description" content="Documentation for Palace."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="Palace logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="Palace logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../run/">Running <em>Palace</em></a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../guide/guide/">Overview</a></li><li><a class="tocitem" href="../guide/problem/">Problem Types</a></li><li><a class="tocitem" href="../guide/model/">Simulation Models</a></li><li><a class="tocitem" href="../guide/boundaries/">Boundary Conditions</a></li><li><a class="tocitem" href="../guide/postprocessing/">Postprocessing and Visualization</a></li></ul></li><li><span class="tocitem">Configuration File</span><ul><li><a class="tocitem" href="../config/config/">Overview</a></li><li><a class="tocitem" href="../config/problem/"><code>config[&quot;Problem&quot;]</code></a></li><li><a class="tocitem" href="../config/model/"><code>config[&quot;Model&quot;]</code></a></li><li><a class="tocitem" href="../config/domains/"><code>config[&quot;Domains&quot;]</code></a></li><li><a class="tocitem" href="../config/boundaries/"><code>config[&quot;Boundaries&quot;]</code></a></li><li><a class="tocitem" href="../config/solver/"><code>config[&quot;Solver&quot;]</code></a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/examples/">Overview</a></li><li><a class="tocitem" href="../examples/spheres/">Capacitance Matrix for Two Spheres</a></li><li><a class="tocitem" href="../examples/rings/">Inductance Matrix for a Pair of Concentric Rings</a></li><li><a class="tocitem" href="../examples/cavity/">Eigenmodes of a Cylindrical Cavity</a></li><li><a class="tocitem" href="../examples/coaxial/">Signal Propagation in a Coaxial Cable</a></li><li><a class="tocitem" href="../examples/cpw/">Crosstalk Between Coplanar Waveguides</a></li></ul></li><li><a class="tocitem" href="../developer/">Developer Notes</a></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#Mathematical-background"><span>Mathematical background</span></a></li><li><a class="tocitem" href="#Time-domain-formulation"><span>Time domain formulation</span></a></li><li><a class="tocitem" href="#Eigenmode-calculations"><span>Eigenmode calculations</span></a></li><li><a class="tocitem" href="#Lumped-ports-and-wave-ports"><span>Lumped ports and wave ports</span></a></li><li><a class="tocitem" href="#Other-boundary-conditions"><span>Other boundary conditions</span></a></li><li><a class="tocitem" href="#Energy-participation-ratios"><span>Energy-participation ratios</span></a></li><li><a class="tocitem" href="#Bulk-and-interface-dielectric-loss"><span>Bulk and interface dielectric loss</span></a></li><li><a class="tocitem" href="#Lumped-parameter-extraction"><span>Lumped parameter extraction</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/awslabs/palace" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/awslabs/palace/blob/main/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><!--- Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved. --->
<!--- SPDX-License-Identifier: Apache-2.0 ---><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><h2 id="Mathematical-background"><a class="docs-heading-anchor" href="#Mathematical-background">Mathematical background</a><a id="Mathematical-background-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-background" title="Permalink"></a></h2><p>The solver computes a finite element approximation to the three-dimensional, time-harmonic Maxwell&#39;s equations in second-order form. The nondimensionalized, source-free, boundary value problem for <span>$\bm{E}(\bm{x})\in\mathbb{C}^3$</span>, <span>$\bm{x}\in\Omega$</span>, <span>$\partial\Omega=\Gamma$</span>, where <span>$\bm{\mathscr{E}}(\bm{x},t) = \text{Re}\{\bm{E}(\bm{x})e^{i\omega t}\}$</span> denotes the electric field, is written as</p><p class="math-container">\[\begin{aligned}
\nabla\times\mu_r^{-1}\nabla\times\bm{E} + i\omega\sigma\bm{E}
    - \omega^2\varepsilon_r\bm{E} &amp;= 0 \,,\; \bm{x}\in\Omega \\
\bm{n}\times\bm{E} &amp;= 0 \,,\; \bm{x}\in\Gamma_{PEC} \\
\bm{n}\times(\mu_r^{-1}\nabla\times\bm{E}) &amp;= 0 \,,\; \bm{x}\in\Gamma_{PMC} \\
\bm{n}\times(\mu_r^{-1}\nabla\times\bm{E})
    + \gamma\bm{n}\times(\bm{n}\times\bm{E}) &amp;= \bm{U}^{inc} \,,\; \bm{x}\in\Gamma_{Z}
\end{aligned}\]</p><p>where the nondimensionalization has been performed with respect to a characteristic length <span>$L_0$</span>, time <span>$L_0/c_0$</span>, magnetic field strength <span>$H_0$</span>, and electric field strength <span>$Z_0 H_0$</span>. Here, <span>$c_0$</span> and <span>$Z_0$</span> are the speed of light and impedance of free space, respectively. This nondimensionalization will be used throughout this entire reference. For more details, see <a href="#References">[1]</a> and <a href="#References">[2]</a>.</p><p>Given the electric field solution, the time-harmonic magnetic flux density can be calculated as</p><p class="math-container">\[\bm{B} = -\frac{1}{i\omega}\nabla\times\bm{E} \,.\]</p><p>The flux density is related to the magnetic field, <span>$\bm{H}$</span>, by the standard linear constitutive relationship <span>$\bm{H} = \mu_r^{-1}\bm{B}$</span>.</p><p>In general, the material property coefficients may be scalar- or matrix-valued. In the matrix-valued (anisotropic) case, the material property coefficients should still always be symmetric.</p><p>For a general isotropic lossy dielectric, the relative permittivity <span>$\varepsilon_r$</span> is a complex-valued quantity:</p><p class="math-container">\[\varepsilon_r = \varepsilon_r&#39; (1-i\tan{\delta})\]</p><p>where <span>$\varepsilon_r&#39;$</span> is the real relative permittivity and <span>$\tan{\delta}$</span> is the loss tangent. Alternatively, conductor loss is modeled by Ohm&#39;s law <span>$\bm{J}=\sigma\bm{E}$</span> with electrical conductivity <span>$\sigma&gt;0.0$</span>. For a superconducting domain, the constitive current-field relationship given by Ohm&#39;s law is replaced by that given by the London equations:</p><p class="math-container">\[\frac{\partial \bm{J}}{\partial t}=\frac{1}{\mu_r\lambda_L^2}\bm{E}\]</p><p>where <span>$\lambda_L = \sqrt{m/\mu n_s e^2}/L_0$</span> is the nondimensionalized London penetration depth. In this case, the term <span>$+i\omega\sigma \bm{E}$</span> arising for a normal conductor in the time-harmonic Maxwell&#39;s equations becomes <span>$+(\mu_r \lambda_L^2)^{-1}\bm{E}$</span>.</p><p>The domain boundary <span>$\Gamma=\Gamma_{PEC}\cup\Gamma_{PMC}\cup\Gamma_{Z}$</span>, is separated into perfect electric conductor (PEC), perfect magnetic conductor (PMC), and impedance boundaries, respectively. The PEC boundary condition is a homogenous Dirichlet condition, while the PMC boundary condition is the natural boundary condition for the problem and is satisfied at all exterior boundaries by the finite element formulation. Impedance boundaries are modeled using a Robin boundary condition with <span>$\gamma = i\omega/Z_s$</span>, in which <span>$Z_s$</span> the surface impedance of the boundary, with units of impedance per square.</p><h2 id="Time-domain-formulation"><a class="docs-heading-anchor" href="#Time-domain-formulation">Time domain formulation</a><a id="Time-domain-formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Time-domain-formulation" title="Permalink"></a></h2><p>A time-dependent formulation is also available to compute the electric field response <span>$\bm{E}(\bm{x},t)$</span> for a given time-dependent source excitation <span>$\bm{U}^{inc}(\bm{x},t)$</span>. The governing equations in this case are</p><p class="math-container">\[\nabla\times\mu_r^{-1}\nabla\times\bm{E} + \sigma\frac{\partial\bm{E}}{\partial t}
    + \varepsilon_r\frac{\partial^2\bm{E}}{\partial t^2} = 0 \,,\; \bm{x}\in\Omega\]</p><p>subject to the same boundary conditions as the frequency-dependent case except for the Robin boundary condition which is written for a lumped resistive port boundary, for example, as</p><p class="math-container">\[\bm{n}\times(\mu_r^{-1}\nabla\times\bm{E})
    + Z_s^{-1}\bm{n}\times\left(\bm{n}\times\frac{\partial\bm{E}}{\partial t}\right)
    = \bm{U}^{inc} \,,\; \bm{x}\in\Gamma_{Z} \,.\]</p><p>The second-order electric field formulation is chosen to take advantage of unconditionally stable implicit time-integration schemes without the expense of a coupled block system solve for <span>$\bm{E}(\bm{x},t)$</span> and <span>$\bm{B}(\bm{x},t)$</span>. It offers the additional benefit of sharing many similarities in the spatial discretization as the frequency domain formulation outlined above.</p><h2 id="Eigenmode-calculations"><a class="docs-heading-anchor" href="#Eigenmode-calculations">Eigenmode calculations</a><a id="Eigenmode-calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenmode-calculations" title="Permalink"></a></h2><p>For eigenmode problems, the source term is zero and a quadratic eigenvalue problem for the eigenvalues <span>$\omega$</span> is solved:</p><p class="math-container">\[(\bm{K}+i\omega\bm{C}-\omega^2\bm{M})\bm{x} = 0\]</p><p>where the matrix <span>$\bm{K}$</span> represents the discretized curl-curl operator, <span>$\bm{M}$</span> the mass term, and <span>$\bm{C}$</span> the port impedance boundary conditions. The damped frequency <span>$\omega_d$</span> and quality factor <span>$Q$</span> are postprocessed from each of the resulting eigenvalues as</p><p class="math-container">\[\omega_d = \text{Re}\{\omega\} \,, \qquad Q = \frac{|\omega|}{2|\text{Im}\{\omega\}|} \,.\]</p><h2 id="Lumped-ports-and-wave-ports"><a class="docs-heading-anchor" href="#Lumped-ports-and-wave-ports">Lumped ports and wave ports</a><a id="Lumped-ports-and-wave-ports-1"></a><a class="docs-heading-anchor-permalink" href="#Lumped-ports-and-wave-ports" title="Permalink"></a></h2><p>For lumped port boundaries, the surface impedance can be related to an equivalent circuit impedance, <span>$Z$</span>. There are two common cases:</p><ol><li><p><em>Rectangular ports</em>: <span>$Z = Z_s l / w$</span>, where <span>$l$</span> and <span>$w$</span> are the length and width of the port, respectively (length here is defined as the distance between the two conductors).</p></li><li><p><em>Coaxial ports</em>: <span>$Z = Z_s \ln(b/a) / 2\pi$</span>, where <span>$a$</span> and <span>$b$</span> denote the inner and outer radii of the port, respectively.</p></li></ol><p>A lumped parallel RLC circuit boundary has a circuit impedance</p><p class="math-container">\[\frac{1}{Z} = \frac{1}{R}+\frac{1}{i\omega L}+i\omega C \,.\]</p><p>Thus, the relationships between the circuit and surface element parameters for the user to specify are given by <span>$R_s = \alpha R$</span>, <span>$L_s = \alpha L$</span>, and <span>$C_s = C/\alpha$</span>, where <span>$\alpha = w/l$</span> for a rectangular port or <span>$\alpha = 2\pi / \ln(b/a)$</span> for a coaxial port.</p><p>For multielement lumped ports, the effective circuit impedance is given by</p><p class="math-container">\[\frac{1}{Z} = \sum_k \frac{1}{Z_k} \,.\]</p><p>That is, the circuit impedances of each port contributing to the multielement port add in parallel. For the specific case of a two element multielement port with two identical lumped elements, we have <span>$Z = (1/Z_1 + 1/Z_2)^{-1} = Z_k / 2$</span>, where <span>$Z_k$</span> is the circuit impedance of a single port element.</p><p>The source term <span>$\bm{U}^{inc}$</span> in a driven frequency-response problem is related to the incident field at an excited port boundary by</p><p class="math-container">\[\bm{U}^{inc} = -2\gamma(\bm{n}\times\bm{E}^{inc})\times\bm{n}\]</p><p>where <span>$(\bm{n}\times\bm{E}^{inc})\times\bm{n}$</span> is just the projection of the excitation field onto the port surface. The incident fields for lumped ports depend on the port shape:</p><ol><li><p><em>Rectangular ports</em>: <span>$\bm{E}^{inc} = E_0 \, \hat{\bm{l}}$</span>, where <span>$E_0$</span> is a uniform constant field strength and <span>$\hat{\bm{l}}$</span> a unit vector defining the direction of polarization on the port (typically should be the direction between the two conductors).</p></li><li><p><em>Coaxial ports</em>: <span>$\bm{E}^{inc} = \frac{E_0 r_0}{r} \, \hat{\bm{r}}$</span>, where <span>$E_0$</span> is again a uniform constant field strength, <span>$r_0$</span> is a characteristic length for the port, <span>$r$</span> is the distance from the port center, and <span>$\hat{\bm{r}}$</span> a unit vector specifying the port radial direction.</p></li></ol><p>In the time domain formulation, the source term <span>$\bm{U}^{inc}$</span> appears as</p><p class="math-container">\[\bm{U}^{inc} = -2 Z_s^{-1}\left(\bm{n}\times\frac{\partial\bm{E}^{inc}}{\partial t}\right)
    \times\bm{n} \,.\]</p><p>The incident field <span>$\bm{E}^{inc}(\bm{x},t)$</span> is</p><p class="math-container">\[\bm{E}^{inc}(\bm{x},t) = p(t)\bm{E}^{inc}(\bm{x})\]</p><p>where <span>$\bm{E}^{inc}(\bm{x})$</span> is identical to the spatial excitation in the frequency domain formulation, and <span>$p(t)$</span> describes the temporal shape of the excitation. Possible options include a sinusoidal, Gaussian, modulated Gaussian, or step excitation.</p><p>In the frequency domain, the scattering parameters can be postprocessed from the computed electric field for each lumped port with boundary <span>$\Gamma_i$</span> as</p><p class="math-container">\[S_{ij} = \frac{\displaystyle\int_{\Gamma_i}\bm{E}\cdot\bm{E}^{inc}_i\,dS}
    {\displaystyle\int_{\Gamma_i}\bm{E}^{inc}_i\cdot\bm{E}^{inc}_i\,dS} - \delta_{ij} \,.\]</p><p>In the time domain, the time histories of the port voltages can be Fourier-transformed to get their frequency domain representation for scattering parameter calculation.</p><p>Numeric wave ports assume a field with known normal-direction dependence <span>$\bm{E}(\bm{x})=\bm{e}(\bm{x}_t)e^{ik_n x_n}$</span> where <span>$k_n$</span> is the propagation constant. For each operating frequency <span>$\omega$</span>, a two-dimensional eigenvalue problem is solved on the port yielding the mode shapes <span>$\bm{e}_m$</span> and associated propagation constants <span>$k_{n,m}$</span>. These are used in the full 3D model where the Robin port boundary condition has coefficient <span>$\gamma=i\text{Re}\{k_{n,m}\}/\mu_r$</span> and the computed mode is used to compute the incident field in the source term <span>$\bm{U}^{inc}$</span> at excited ports. Scattering parameter postprocessing takes the same form as the lumped port counterpart using the computed modal solutions. Since the propagation constants are known for each wave port, scattering parameter de-embedding can be performed by specifying an offset distance <span>$d$</span> for each port:</p><p class="math-container">\[\tilde{S}_{ij} = S_{ij}e^{ik_{n,i}d_i}e^{ik_{n,j}d_j} \,.\]</p><p>For more information on the implementation of numeric wave ports, see <a href="#References">[3]</a>.</p><h2 id="Other-boundary-conditions"><a class="docs-heading-anchor" href="#Other-boundary-conditions">Other boundary conditions</a><a id="Other-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Other-boundary-conditions" title="Permalink"></a></h2><p>The first-order absorbing boundary condition, also referred to as a scattering boundary condition, is a special case of the general impedance boundary condition described above:</p><p class="math-container">\[\bm{n}\times(\mu_r^{-1}\nabla\times\bm{E})
    + i\omega\sqrt{\mu_r^{-1}\varepsilon_r}\bm{n}\times(\bm{n}\times\bm{E}) = 0 \,.\]</p><p>This is also known as the Sommerfeld radiation condition, and one can recognize the dependence on the impedance of free space <span>$Z_0^{-1}=\sqrt{\mu_r^{-1}\varepsilon_r}$</span>. The second-order absorbing boundary condition is</p><p class="math-container">\[\bm{n}\times(\mu_r^{-1}\nabla\times\bm{E})
    + i\omega\sqrt{\mu_r^{-1}\varepsilon_r}\bm{n}\times(\bm{n}\times\bm{E})
    - \beta\nabla\times[(\nabla\times\bm{E})_n\bm{n}] = 0\]</p><p>where assuming an infinite radius of curvature <span>$\beta=\mu_r^{-1}c_0/(2i\omega)$</span>, and the contribution depending on <span>$(\nabla\cdot\bm{E}_t)$</span> has been neglected.</p><p>Additionally, while metals with finite conductivity can be modeled using an impedance boundary condition with constant impedance <span>$Z_s$</span>, a more accurate model taking into account the frequency dependence of the skin depth is</p><p class="math-container">\[Z_s = \frac{1+i}{\delta\sigma}\]</p><p>where <span>$\delta=\sqrt{2/\mu_r\sigma\omega}$</span> is the skin depth and <span>$\sigma$</span> is the conductivity of the metal. Another model, which takes into account finite thickness effects, is given by</p><p class="math-container">\[Z_s = \frac{1}{\delta\sigma}\left(\frac{\sinh{\nu}+\sin{\nu}}{\cosh{\nu}+\cos{\nu}}
    + i\frac{\sinh{\nu}-\sin{\nu}}{\cosh{\nu}+\cos{\nu}}\right)\]</p><p>where <span>$\nu=h/\delta$</span> and <span>$h$</span> is the layer thickness. This model correctly produces the DC limit when <span>$h\ll\delta$</span>.</p><h2 id="Energy-participation-ratios"><a class="docs-heading-anchor" href="#Energy-participation-ratios">Energy-participation ratios</a><a id="Energy-participation-ratios-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-participation-ratios" title="Permalink"></a></h2><p>The energy-participation ratio (EPR) for lumped inductive elements is computed from the electric and magnetic fields corresponding to eigenmode <span>$m$</span>, <span>$\bm{E}_m$</span> and <span>$\bm{H}_m$</span>, using the formula</p><p class="math-container">\[p_{mj} = \frac{1}{\mathcal{E}^{elec}_m} \, \frac{1}{2} \, L_j I_{mj}^2\]</p><p>where <span>$p_{mj}\in[-1,1]$</span> denotes the signed participation ratio for junction <span>$j$</span> in mode <span>$m$</span>, <span>$L_j$</span> is the provided junction circuit inductance, <span>$I_ {mj}$</span> is the peak junction current for mode <span>$m$</span>, and <span>$\mathcal{E}^{elec}_m$</span> is the electric energy in mode <span>$m$</span>. The junction current is computed using the mean voltage across the port, <span>$\overline{V}_{mj}$</span>, as <span>$I_{mj} = \overline{V}_{mj}/Z_{mj}$</span>, where <span>$Z_{mj} = 1/(i\omega_m L_j)$</span> is the impedance of the inductive branch of the lumped circuit. The mean port voltage depends on the computed electric field mode and the shape of the port:</p><ol><li><p><em>Rectangular ports</em>: <span>$\overline{V}_{mj} = \frac{1}{w_j}\int_{\Gamma_j}\bm{E}_m\cdot\hat{\bm{l}}_j\,dS$</span>.</p></li><li><p><em>Coaxial ports</em>: <span>$\overline{V}_{mj} = \frac{1}{2\pi}\int_{\Gamma_j}\frac{\bm{E}_m}{r}\cdot\hat{\bm{r}}_j\,dS$</span>.</p></li></ol><p>Finally, the total electric energy in mode <span>$m$</span> is</p><p class="math-container">\[\mathcal{E}^{elec}_m
    = \frac{1}{2} \, \text{Re}\left\{\int_\Omega\bm{D}_m^*\cdot\bm{E}_m\,dV\right\}
    + \sum_j \frac{1}{2} \, C_jV_{mj}^2\]</p><p>where <span>$\bm{D}_m=\varepsilon_r\bm{E}_m$</span> is the electric flux density for mode <span>$m$</span> and the second term on the right-hand side accounts for any lumped capacitive boundaries with nonzero circuit capacitance <span>$C_j$</span>.</p><p>The EPR can also be used to estimate mode quality factors due to input-output(I-O) line coupling. The mode coupling quality factor due to the <span>$j$</span>-th I-O port is given by</p><p class="math-container">\[Q_{mj} = \frac{\omega_m}{\kappa_{mj}}\]</p><p>where the port coupling rate <span>$\kappa_{mj}$</span> is calculated as</p><p class="math-container">\[\kappa_{mj} = \frac{1}{\mathcal{E}^{elec}_m} \, \frac{1}{2}\,R_j I_{mj}^2 \,.\]</p><h2 id="Bulk-and-interface-dielectric-loss"><a class="docs-heading-anchor" href="#Bulk-and-interface-dielectric-loss">Bulk and interface dielectric loss</a><a id="Bulk-and-interface-dielectric-loss-1"></a><a class="docs-heading-anchor-permalink" href="#Bulk-and-interface-dielectric-loss" title="Permalink"></a></h2><p>The quality factor due to bulk dielectric loss resulting from an electric field <span>$\bm{E}$</span> present in domain <span>$j$</span> with associated loss tangent <span>$\tan{\delta}_j$</span> is given by</p><p class="math-container">\[\frac{1}{Q_j} = p_j \tan{\delta}_j =
    \frac{1}{\mathcal{E}^{elec}} \, \frac{1}{2} \, \tan{\delta}_j \,
    \text{Re}\left\{\int_{\Omega_j}\bm{D}^*\cdot\bm{E}\,dV\right\}\]</p><p>where, as above, <span>$\mathcal{E}^{elec}$</span> is the total electric field energy in the domain, including the contributions due to capacitive lumped elements.</p><p>Likewise, the quality factor due to surface interface dielectric loss for interface <span>$j$</span> is given by</p><p class="math-container">\[\frac{1}{Q_j} = p_j \tan{\delta}_j =
    \frac{1}{\mathcal{E}^{elec}} \, \frac{1}{2} \, t_j\tan{\delta}_j \,
    \text{Re}\left\{\int_{\Gamma_j}\bm{D}^*\cdot\bm{E}\,dS\right\}\]</p><p>where <span>$t_j$</span> is the thickness of the layer and <span>$\bm{D} = \varepsilon_{r,j}\bm{E}$</span> is the electric displacement field in the layer evaluated using the relative permittivity of the interface <span>$\varepsilon_{r,j}$</span>. For an internal boundary, this integral is evaluated on a single side to resolve abiguity due to the discontinuity of <span>$\bm{E}$</span> across the boundary.</p><p>The above formula for interface dielectric loss can be specialized for the case of a metal-air, metal-substrate, or substrate-air interface <a href="#References">[4]</a>. In each case, the quality factor for interface <span>$j$</span> is given by</p><ul><li><em>Metal-air</em>:</li></ul><p class="math-container">\[\frac{1}{Q^{MA}_j} =
    \frac{1}{\mathcal{E}^{elec}} \, \frac{1}{2} \,
    \frac{t_j\tan{\delta}_j}{\varepsilon_{r,j}^{MA}} \,
    \text{Re}\left\{\int_{\Gamma_j}\bm{E}_n^*\cdot\bm{E}_n\,dS\right\}\]</p><ul><li><em>Metal-substrate</em>:</li></ul><p class="math-container">\[\frac{1}{Q^{MS}_j} =
    \frac{1}{\mathcal{E}^{elec}} \, \frac{1}{2} \,
    \frac{t_j\tan{\delta}_j(\varepsilon_{r,j}^{S})^2}{\varepsilon_{r,j}^{MS}} \,
    \text{Re}\left\{\int_{\Gamma_j}\bm{E}_n^*\cdot\bm{E}_n\,dS\right\}\]</p><ul><li><em>Substrate-air</em>:</li></ul><p class="math-container">\[\frac{1}{Q^{SA}_j} =
    \frac{1}{\mathcal{E}^{elec}} \, \frac{1}{2} \,
    t_j\tan{\delta}_j\left(\varepsilon_{r,j}^{SA} \,
    \text{Re}\left\{\int_{\Gamma_j}\bm{E}_t^*\cdot\bm{E}_t\,dS\right\}
    + \frac{1}{\varepsilon_{r,j}^{SA}} \,
    \text{Re}\left\{\int_{\Gamma_j}\bm{E}_n^*\cdot\bm{E}_n\,dS\right\}\right)\]</p><p>where <span>$\bm{E}_n$</span> denotes the normal field to the interface and <span>$\bm{E}_t=\bm{E}-\bm{E}_n$</span> denotes the tangential field.</p><h2 id="Lumped-parameter-extraction"><a class="docs-heading-anchor" href="#Lumped-parameter-extraction">Lumped parameter extraction</a><a id="Lumped-parameter-extraction-1"></a><a class="docs-heading-anchor-permalink" href="#Lumped-parameter-extraction" title="Permalink"></a></h2><p>For electrostatic simulations, the Maxwell capacitance matrix is computed in the following manner. First, the Laplace equation subject to Dirichlet boundary conditions is solved for each terminal with boundary <span>$\Gamma_i$</span> in the model, yielding an associated voltage field <span>$V_i(\bm{x})$</span>:</p><p class="math-container">\[\begin{aligned}
\nabla\cdot(\varepsilon_r\nabla V_i) &amp;= 0 \,,\; \bm{x}\in\Omega \\
V_i &amp;= 1 \,,\; \bm{x}\in\Gamma_i \\
V_i &amp;= 0 \,,\; \bm{x}\in\Gamma_j \,,\; j\neq i \,.
\end{aligned}\]</p><p>The energy of the electric field associated with any solution is</p><p class="math-container">\[\mathcal{E}(V_i) = \frac{1}{2}\int_\Omega\varepsilon_r\bm{E}_i\cdot\bm{E}_i\,dV\]</p><p>where <span>$\bm{E}_i=-\nabla V_i$</span> is the electric field. Then, the entries of the Maxwell capacitance matrix, <span>$\bm{C}$</span>, are given by</p><p class="math-container">\[\bm{C}_{ij} = \mathcal{E}(V_i+V_j)-\frac{1}{2}(\bm{C}_{ii}+\bm{C}_{jj}) \,.\]</p><p>Magnetostatic problems for inductance matrix extraction are based on the magnetic vector potential formulation:</p><p class="math-container">\[\begin{aligned}
\nabla\times(\mu_r^{-1}\nabla\times\bm{A}_i) &amp;= 0 \,,\; \bm{x}\in\Omega \\
\bm{n}\times(\mu_r^{-1}\nabla\times\bm{A}_i) =
    \bm{n}\times\bm{H}_i &amp;= \bm{J}_s^{inc} \,,\; \bm{x}\in\Gamma_i \\
\bm{n}\times(\mu_r^{-1}\nabla\times\bm{A}_i) &amp;= 0 \,,\; \bm{x}\in\Gamma_j \,,\; j\neq i \,.
\end{aligned}\]</p><p>For each port with boundary <span>$\Gamma_i$</span>, a unit source surface current <span>$\bm{J}_s^{inc}$</span> is applied, yielding an associated vector potential solution <span>$\bm{A}_i(\bm{x})$</span>. Homogeneous Dirichlet boundary conditions <span>$\bm{n}\times\bm{A}_i=0$</span> are also imposed on specified surfaces of the model. The magnetic field energy associated with any solution is</p><p class="math-container">\[\mathcal{E}(\bm{A}_i) = \frac{1}{2}\int_\Omega\mu_r^{-1}\bm{B}_i\cdot\bm{B}_i\,dV\]</p><p>where <span>$\bm{B}_i=\nabla\times\bm{A}_i$</span> is the magnetic flux density. Then, the entries of the inductance matrix, <span>$\bm{M}$</span>, are given by</p><p class="math-container">\[\bm{M}_{ij} = \frac{1}{I_i I_j}\mathcal{E}(\bm{A}_i+\bm{A}_j)
    - \frac{1}{2}\left(\frac{I_i}{I_j}\bm{M}_{ii}+\frac{I_j}{I_i}\bm{M}_{jj}\right)\]</p><p>where <span>$I_i$</span> is the excitation current for port <span>$i$</span>, computed by integrating the source surface current <span>$\bm{J}_s^{inc}$</span> over the surface of the port.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] J.-M. Jin, <em>The Finite Element Method in Electromagnetics</em>, Wiley-IEEE Press, Hoboken, NJ, Third edition, 2014.<br/>[2] P. Monk, <em>Finite Element Methods for Maxwell&#39;s Equations</em>, Oxford University Press, Oxford, 2003.<br/>[3] L. Vardapetyan and L. Demkowicz, Full-wave analysis of dielectric waveguides at a given frequency, <em>Mathematics of Computation</em> 72 (2003) 105-129.<br/>[4] J. Wenner, R. Barends, R. C. Bialczak, et al., Surface loss of superconducting coplanar waveguide resonators, <em>Applied Physics Letters</em> 99, 113513 (2011).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../developer/">« Developer Notes</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 15 February 2024 22:57">Thursday 15 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
