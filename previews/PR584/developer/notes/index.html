<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Developer Notes · Palace</title><meta name="title" content="Developer Notes · Palace"/><meta property="og:title" content="Developer Notes · Palace"/><meta property="twitter:title" content="Developer Notes · Palace"/><meta name="description" content="Documentation for Palace."/><meta property="og:description" content="Documentation for Palace."/><meta property="twitter:description" content="Documentation for Palace."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="Palace logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="Palace logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick/">Quick Start</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../run/">Running <em>Palace</em></a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../guide/guide/">Overview</a></li><li><a class="tocitem" href="../../guide/problem/">Problem Types</a></li><li><a class="tocitem" href="../../guide/model/">Simulation Models</a></li><li><a class="tocitem" href="../../guide/boundaries/">Boundary Conditions</a></li><li><a class="tocitem" href="../../guide/postprocessing/">Postprocessing and Visualization</a></li><li><a class="tocitem" href="../../guide/parallelism/">Parallelism and GPU Support</a></li></ul></li><li><span class="tocitem">Configuration File</span><ul><li><a class="tocitem" href="../../config/config/">Overview</a></li><li><a class="tocitem" href="../../config/problem/"><code>config[&quot;Problem&quot;]</code></a></li><li><a class="tocitem" href="../../config/model/"><code>config[&quot;Model&quot;]</code></a></li><li><a class="tocitem" href="../../config/domains/"><code>config[&quot;Domains&quot;]</code></a></li><li><a class="tocitem" href="../../config/boundaries/"><code>config[&quot;Boundaries&quot;]</code></a></li><li><a class="tocitem" href="../../config/solver/"><code>config[&quot;Solver&quot;]</code></a></li></ul></li><li><span class="tocitem">Features</span><ul><li><a class="tocitem" href="../../features/farfield/">Extracting Fields in the Radiation Zone</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Overview</a></li><li><a class="tocitem" href="../../examples/spheres/">Capacitance Matrix for Two Spheres</a></li><li><a class="tocitem" href="../../examples/rings/">Inductance Matrix for a Pair of Concentric Rings</a></li><li><a class="tocitem" href="../../examples/antenna/">Dipole Antenna and Radiation Fields</a></li><li><a class="tocitem" href="../../examples/cylinder/">Eigenmodes of a Cylinder</a></li><li><a class="tocitem" href="../../examples/coaxial/">Signal Propagation in a Coaxial Cable</a></li><li><a class="tocitem" href="../../examples/cpw/">Crosstalk Between Coplanar Waveguides</a></li></ul></li><li><a class="tocitem" href="../../faq/">Frequently Asked Questions</a></li><li><span class="tocitem">For Developers</span><ul><li class="is-active"><a class="tocitem" href>Developer Notes</a><ul class="internal"><li><a class="tocitem" href="#Units"><span>Units</span></a></li><li><a class="tocitem" href="#Style-guide"><span>Style guide</span></a></li><li><a class="tocitem" href="#Static-analysis"><span>Static analysis</span></a></li><li><a class="tocitem" href="#Extending-GPU-code-in-*Palace*"><span>Extending GPU code in <em>Palace</em></span></a></li><li><a class="tocitem" href="#JSON-Schema-for-configuration-files"><span>JSON Schema for configuration files</span></a></li><li><a class="tocitem" href="#Timing"><span>Timing</span></a></li><li><a class="tocitem" href="#Profiling-*Palace*-on-CPUs"><span>Profiling <em>Palace</em> on CPUs</span></a></li><li><a class="tocitem" href="#Changelog"><span>Changelog</span></a></li></ul></li><li><a class="tocitem" href="../testing/">Testing</a></li><li><a class="tocitem" href="../tutorial_add_new_unit_test/">Tutorial: Adding a New Unit Test</a></li><li><a class="tocitem" href="../tutorial_gpu_profiling/">Tutorial: GPU Profiling with NVIDIA Nsight Systems and NVTX</a></li></ul></li><li><a class="tocitem" href="../../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">For Developers</a></li><li class="is-active"><a href>Developer Notes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Developer Notes</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/awslabs/palace" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/awslabs/palace/blob/main/docs/src/developer/notes.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><!--- Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved. --->
<!--- SPDX-License-Identifier: Apache-2.0 ---><h1 id="Developer-Notes"><a class="docs-heading-anchor" href="#Developer-Notes">Developer Notes</a><a id="Developer-Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Developer-Notes" title="Permalink"></a></h1><h2 id="Units"><a class="docs-heading-anchor" href="#Units">Units</a><a id="Units-1"></a><a class="docs-heading-anchor-permalink" href="#Units" title="Permalink"></a></h2><p>For interactions with users (inputs and outputs), <em>Palace</em> mostly uses SI units, and where it doesn&#39;t it uses metric units (SI with prefix modifiers e.g. km, um, nJ). However, internally, there are three unit systems that are used within any given <em>Palace</em> simulation.</p><p>First, the mesh comes with its own unit of length. Users specify the conversion between one unit of length on the mesh to meters through the <a href="../../config/problem/#config%5B%Model%22%5D"><code>config[&quot;Model&quot;][&quot;L0&quot;]</code></a> parameter.</p><p>Second, <em>Palace</em> defines a system of non-dimensional units where the actual solver operates.</p><p>Third, postprocessing occurs in a custom variant of SI units where the unit of time is nanoseconds instead of seconds. This is more suitable for the problems <em>Palace</em> is designed to solve.</p><p>The second and third systems are described by the <code>Units</code> class defined in <code>units.hpp</code>.</p><h3 id="Non-dimensional-unit-system"><a class="docs-heading-anchor" href="#Non-dimensional-unit-system">Non-dimensional unit system</a><a id="Non-dimensional-unit-system-1"></a><a class="docs-heading-anchor-permalink" href="#Non-dimensional-unit-system" title="Permalink"></a></h3><p>The non-dimensional unit system is constructed as follows:</p><p>Length: Lengths are measured in units of the characteristic length <code>Lc</code>, which is the mesh size in mesh units, unless <code>Lc</code> is manually specified in <a href="../../config/problem/#config%5B%Model%22%5D"><code>config[&quot;Model&quot;][&quot;Lc&quot;]</code></a>. The extent of the mesh is 1 in these units, with extent defined as the largest single dimension (e.g., for a cuboid of size 10m x 20m x 40m, this would be 40m).</p><p>Time: One unit of non-dimensional time is the time it takes light to travel one <code>Lc</code> (equivalently, the speed of light is 1 in these units).</p><p>Electromagnetic quantities: <em>Palace</em> uses <a href="https://en.wikipedia.org/wiki/Heaviside%E2%80%93Lorentz_units">Heaviside-Lorentz</a> units, essentially meaning that <code>ε₀ = μ₀ = 1</code> (so that in addition to setting <code>c = 1</code>, the impedance of free space <code>Z₀</code> is also 1).</p><p>The final unit in the system is chosen so that the power flowing through a surface of area <code>Lc²</code> perpendicular to the direction of propagation in vacuum with a uniform magnetic field of strength 1 is exactly 1 (<code>P = H^2 * Z * L^2</code>, with <code>Z</code> impedance). This choice is related to the normalization of power across ports.</p><p>An equivalent mental model about non-dimensional quantities in <em>Palace</em> is to think in terms of characteristic values instead of units: the non-dimensional quantities are physical quantities normalized by reference values. These reference values are effectively chosen to satisfy the constraints on space, time and power given above. For example, the magnetic field strength <code>H</code> solved for is actually <code>H/Hc</code>, where <code>Hc</code> satisfies <code>Hc² × Z₀ × Lc² = 1 W</code>, with <code>Z₀</code> impedance of free space. Similarly, the non-dimensional electric field <code>E</code> is <code>E/Ec</code> with <code>Ec = Z₀ × Hc</code>.</p><div class="admonition is-info" id="Example:-converting-times-and-distances-24434e05563f6fef"><header class="admonition-header">Example: converting times and distances<a class="admonition-anchor" href="#Example:-converting-times-and-distances-24434e05563f6fef" title="Permalink"></a></header><div class="admonition-body"><p>Consider a spherical mesh with <code>L0</code> of 1 micron and radius of 3 in mesh units. Then:</p><ul><li>Mesh size in mesh units: 6</li><li>Mesh size in non-dimensional units: 1</li><li>Mesh size in dimensional units: 6e-6</li><li>Mesh size in SI: 6e-6 meters</li><li>Speed of light in non-dimensional units: 1</li><li>Speed of light in dimensional units: 0.3</li><li>Speed of light in SI: 3e8 meters/seconds</li><li>Time for light to cross the sphere in non-dimensional units: 1</li><li>Time for light to cross the sphere in dimensional units: 2e-5</li><li>Time for light to cross the sphere in SI: 2e-14 seconds</li></ul></div></div><div class="admonition is-warning" id="Non-SI-time-units-c71735cebd86a0a2"><header class="admonition-header">Non-SI time units<a class="admonition-anchor" href="#Non-SI-time-units-c71735cebd86a0a2" title="Permalink"></a></header><div class="admonition-body"><p>The dimensional unit system uses nanoseconds for time, not seconds. This affects unit combinations: <code>units::POWER * units::TIME</code> is not equivalent to <code>units::ENERGY</code>. This choice of nanoseconds reflects a prioritization of the microwave engineering domain within <em>Palace</em>, as the typical frequencies in GHz (which correspond to time scales of nanoseconds).</p></div></div><div class="admonition is-warning" id="Omega-instead-of-Frequency-6ab3aae0d89dbe04"><header class="admonition-header">Omega instead of Frequency<a class="admonition-anchor" href="#Omega-instead-of-Frequency-6ab3aae0d89dbe04" title="Permalink"></a></header><div class="admonition-body"><p>Internally, <em>Palace</em> uses the angular frequency <code>omega</code> instead of the regular frequency, with both names <code>omega</code> and <code>freq</code> being used.</p></div></div><div class="admonition is-warning" id="Finite-element-considerations-a1858eeb694e6ba"><header class="admonition-header">Finite element considerations<a class="admonition-anchor" href="#Finite-element-considerations-a1858eeb694e6ba" title="Permalink"></a></header><div class="admonition-body"><p>Changing mesh units requires additional rescaling for fields defined on H(curl) and H(div) spaces to convert them to proper physical units. This is a function of the length scales inherent to the reference element transformations for Nédélec and Raviart Thomas spaces, used for H(curl) and H(div) respectively. See the <code>ScaleGridFunctions</code> function in <code>PostOperator</code> for details.</p></div></div><h2 id="Style-guide"><a class="docs-heading-anchor" href="#Style-guide">Style guide</a><a id="Style-guide-1"></a><a class="docs-heading-anchor-permalink" href="#Style-guide" title="Permalink"></a></h2><p>Automated source code formatting is performed using <a href="https://clang.llvm.org/docs/ClangFormat.html"><code>clang-format</code></a>. Run:</p><pre><code class="language-bash hljs">./scripts/format_source</code></pre><p>in the repository root directory to automatically use <code>clang-format</code> to format <code>C++</code> source as well as <a href="https://github.com/domluna/JuliaFormatter.jl"><code>JuliaFormatter.jl</code></a> for Julia and Markdown files. The script can be viewed <a href="https://github.com/awslabs/palace/blob/main/scripts/format_source">in the repository</a>.</p><p>The following conventions also apply:</p><ul><li><code>PascalCase</code> for classes and function names.</li><li>Follow &#39;include what you use&#39; (IWYU), with the include order dictated by the <a href="https://google.github.io/styleguide/cppguide.html#Names_and_Order_of_Includes">Google C++ Style Guide</a>. This order should be automatically enforced by the <code>clang-format</code> <a href="https://github.com/awslabs/palace/blob/main/.clang-format">style file</a>.</li><li>Code comments should be full sentences, with punctuation. At this time, no Doxygen API reference is generated and so comments generally do not need to conform to Doxygen syntax.</li></ul><h2 id="Static-analysis"><a class="docs-heading-anchor" href="#Static-analysis">Static analysis</a><a id="Static-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Static-analysis" title="Permalink"></a></h2><p>During the <code>cmake</code> configuration step, defining the variables <code>ANALYZE_SOURCES_CLANG_TIDY</code> and <code>ANALYZE_SOURCES_CPPCHECK</code> to <code>ON</code> will turn on static analysis using <a href="https://clang.llvm.org/extra/clang-tidy/"><code>clang-tidy</code></a> and <a href="https://cppcheck.sourceforge.io/"><code>cppcheck</code></a>, respectively, during the build step. This requires the executables to be installed and findable by CMake on your system.</p><h2 id="Extending-GPU-code-in-*Palace*"><a class="docs-heading-anchor" href="#Extending-GPU-code-in-*Palace*">Extending GPU code in <em>Palace</em></a><a id="Extending-GPU-code-in-*Palace*-1"></a><a class="docs-heading-anchor-permalink" href="#Extending-GPU-code-in-*Palace*" title="Permalink"></a></h2><p><em>Palace</em> supports <a href="../../guide/parallelism/">GPU parallelization</a>, but not all the files in <em>Palace</em> are compiled with a GPU-compatible compiler (e.g., <code>nvcc</code>). The reason for this is that such compilers might not support all the features <em>Palace</em> needs (e.g., support for <code>constexpr std::sqrt</code>), and also because they tend to be slower. The list of files that contains code that has to run on the device is defined by the <code>TARGET_SOURCES_DEVICE</code> CMake variable.</p><h2 id="JSON-Schema-for-configuration-files"><a class="docs-heading-anchor" href="#JSON-Schema-for-configuration-files">JSON Schema for configuration files</a><a id="JSON-Schema-for-configuration-files-1"></a><a class="docs-heading-anchor-permalink" href="#JSON-Schema-for-configuration-files" title="Permalink"></a></h2><p>A JSON format <a href="../../config/config/">configuration file</a>, for example named <code>config.json</code>, can be validated against the provided Schema using:</p><pre><code class="language-bash hljs">./scripts/validate_config config.json</code></pre><p><a href="https://github.com/awslabs/palace/blob/main/scripts/validate_config">This script</a> uses Julia&#39;s <a href="https://github.com/fredo-dedup/JSONSchema.jl"><code>JSONSchema.jl</code></a> and the Schema provided in <a href="https://github.com/awslabs/palace/blob/main/scripts/schema"><code>scripts/schema/</code></a> to parse the configuration file and check that the fields are correctly specified. This script and the associated Schema are also installed and can be accessed in <code>&lt;INSTALL_DIR&gt;/bin</code>.</p><h2 id="Timing"><a class="docs-heading-anchor" href="#Timing">Timing</a><a id="Timing-1"></a><a class="docs-heading-anchor-permalink" href="#Timing" title="Permalink"></a></h2><p>Timing facilities are provided by the <code>Timer</code> and <code>BlockTimer</code> classes.</p><p>Creating a block as <code>BlockTimer b(idx)</code> where <code>idx</code> is a category like <code>CONSTRUCT</code>, <code>SOLVE</code>, etc. will record time so long as <code>b</code> is in scope; however, timing may be interrupted by creation of another <code>BlockTimer</code> object. It will resume whenever the new block is destroyed. Only one category is timed at once. This enables functions to declare how calls within them are timed without needing to know how timing may be done by the calling function.</p><p>The <code>BlockTimer</code> implementation relies upon a static member object of the <code>Timer</code> class, which behaves as a stopwatch with some memory functions. It is the responsibility of this <code>BlockTimer::timer</code> object to record time spent in each recorded category. Other <code>Timer</code> objects may be created for local timing purposes, but these will not count toward time reported at the end of a log file or in the metadata JSON.</p><p>For each <em>Palace</em> simulation, a table of timing statistics is printed out before the program terminates. The minimum, maximum, and average times across all MPI processes are included in the table. Timer categories are exclusive, they do not overlap. The categories for breaking down the total simulation time are:</p><pre><code class="nohighlight hljs">Initialization                  // &lt; Time spent parsing the configuration file,
                                //   preprocessing and partitioning the mesh
Operator Construction           // &lt; Time spent constructing finite element spaces and
                                //   setting up linear and bilinear forms on those spaces
  Wave Ports                    // &lt; Time spent configuring and computing the modes
                                //   associated with wave port boundaries
Linear Solve                    // &lt; Linear solver time
  Setup                         // &lt; Setup time for linear solver and preconditioner
  Preconditioner                // &lt; Preconditioner application time for linear solve
  Coarse Solve                  // &lt; Coarse solve time for geometric multigrid
                                //   preconditioners
Time Stepping                   // &lt; Time spent in the time integrator for transient
                                //   simulation types
Eigenvalue Solve                // &lt; Time spent in the eigenvalue solver (not including
                                //   linear solves for the spectral transformation, or
                                //   divergence-free projection)
Div.-Free Projection            // &lt; Time spent performing divergence-free projection (used
                                //   for eigenmode simulations)
PROM Construction               // &lt; Offline PROM construction time for adaptive fast
                                //   frequency sweep
PROM Solve                      // &lt; Online PROM solve and solution prolongation time for
                                //   adaptive fast frequency sweep
Estimation                      // &lt; Time spent computing element-wise error estimates
  Construction                  // &lt; Construction time for error estimation global linear
                                //   solve
  Solve                         // &lt; Solve time for error estimation global linear solve
Adaptation                      // &lt; Time spent performing adaptive mesh refinement (AMR)
  Rebalancing                   // &lt; Rebalancing time for AMR simulations with rebalancing
Postprocessing                  // &lt; Time spent in postprocessing once the field solution
                                //   has been computed
  Far Fields                    // &lt; Time spent computing surface integrals to extrapolate
                                //   near fields to far fields
  Paraview                      // &lt; Processing and writing Paraview fields for visualization
  Grid function                 // &lt; Processing and writing grid function fields for visualization
Disk IO                         // &lt; Disk read/write time for loading the mesh file and
                                //   writing CSV fields
-----------------------
Total                           // &lt; Total simulation time</code></pre><h2 id="Profiling-*Palace*-on-CPUs"><a class="docs-heading-anchor" href="#Profiling-*Palace*-on-CPUs">Profiling <em>Palace</em> on CPUs</a><a id="Profiling-*Palace*-on-CPUs-1"></a><a class="docs-heading-anchor-permalink" href="#Profiling-*Palace*-on-CPUs" title="Permalink"></a></h2><p>A typical <em>Palace</em> simulation spends most of its time in libCEED kernels, which, in turn, executed <code>libsxmm</code> code on CPUs. Libsxmm generates code just-in-time to ensure it is the most performant on the given architecture and for the given problem. This code generation confuses most profilers. Luckily, <a href="https://libxsmm.readthedocs.io/en/latest/libxsmm_prof/">libsxmm</a> can integrate with the VTune APIs to enable profiling of jitted functions as well.</p><div class="admonition is-info" id="Using-a-different-libCEED-backend?-f23b8b52b48e0d10"><header class="admonition-header">Using a different libCEED backend?<a class="admonition-anchor" href="#Using-a-different-libCEED-backend?-f23b8b52b48e0d10" title="Permalink"></a></header><div class="admonition-body"><p>The following notes assume that you are using the <code>libxsmm</code> backend for libCEED. If this is not the case and you have a preference for other profilers, such as <a href="https://perfwiki.github.io/main/">perf</a> or <a href="https://hpctoolkit.org/">HPCToolkit</a>, you can consider using them as well.</p></div></div><h3 id="Requirements"><a class="docs-heading-anchor" href="#Requirements">Requirements</a><a id="Requirements-1"></a><a class="docs-heading-anchor-permalink" href="#Requirements" title="Permalink"></a></h3><ol><li>Verify your system meets the <a href="https://www.intel.com/content/www/us/en/developer/articles/system-requirements/vtune-profiler/2025-1.html">VTune system requirements</a></li><li><a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/vtune-profiler-download.html">Install VTune Profiler</a></li><li>Set VTune&#39;s root directory during Palace build (see below)</li><li>Use <code>RelWithDebInfo</code> build type for optimal profiling results</li></ol><h3 id="Building-*Palace*-with-VTune-Support"><a class="docs-heading-anchor" href="#Building-*Palace*-with-VTune-Support">Building <em>Palace</em> with VTune Support</a><a id="Building-*Palace*-with-VTune-Support-1"></a><a class="docs-heading-anchor-permalink" href="#Building-*Palace*-with-VTune-Support" title="Permalink"></a></h3><p>From the <em>Palace</em> root directory:</p><pre><code class="language-bash hljs">$ source /path/to/vtune-vars.sh # Replace with your VTune installation path
$ mkdir build &amp;&amp; cd build
$ cmake .. -DCMAKE_BUILD_TYPE=RelWithDebInfo
$ make -j $(nproc)</code></pre><h3 id="Running-a-Basic-Profile"><a class="docs-heading-anchor" href="#Running-a-Basic-Profile">Running a Basic Profile</a><a id="Running-a-Basic-Profile-1"></a><a class="docs-heading-anchor-permalink" href="#Running-a-Basic-Profile" title="Permalink"></a></h3><p>A flamegraph can be created using either:</p><ul><li>The VTune graphical user interface</li><li>The command line interface</li></ul><p>Follow <a href="https://www.intel.com/content/www/us/en/docs/vtune-profiler/user-guide/2024-2/launch.html">Intel&#39;s official instructions</a> for detailed usage information.</p><p>Below is a sample flamegraph resulted from profiling the rings example located at <a href="https://github.com/awslabs/palace/blob/main/examples/rings/rings.json"><code>/examples/rings/rings.json</code></a> with polynomial order P=6 (<code>Solver[&quot;Order&quot;]: 6</code>).</p><br/><p align="center">
  <img src="../../assets/profiling/vtune-flamegraph.png" width="100%" />
</p><br/><p><strong>Note:</strong> Set <code>Verbose: 0</code> in the JSON file to reduce terminal output. For profiling, use the binary executable (<code>build/bin/palace-*.bin</code>) rather than the <code>build/bin/palace</code> wrapper script.</p><p>For <a href="https://www.intel.com/content/www/us/en/docs/vtune-profiler/cookbook/2023-0/profiling-mpi-applications.html">MPI profiling</a> with multiple processes:</p><pre><code class="language-bash hljs"># Run with 10 MPI processes
$ cd /path/to/palace/examples/rings
$ mpirun -n 10 -gtool &quot;vtune -collect hpc-performance --app-working-dir=$(pwd) -result-dir $(pwd)/vtune-mpi:0-9&quot; /path/to/palace/build/bin/palace-x86_64.bin rings.json

# Open the results from VTune GUI
$ vtune-gui vtune-mpi.*</code></pre><h2 id="Changelog"><a class="docs-heading-anchor" href="#Changelog">Changelog</a><a id="Changelog-1"></a><a class="docs-heading-anchor-permalink" href="#Changelog" title="Permalink"></a></h2><p>Code contributions should generally be accompanied by an entry in the <a href="https://github.com/awslabs/palace/blob/main/CHANGELOG.md">changelog</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../faq/">« Frequently Asked Questions</a><a class="docs-footer-nextpage" href="../testing/">Testing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 17 December 2025 23:23">Wednesday 17 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
