<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Testing · Palace</title><meta name="title" content="Testing · Palace"/><meta property="og:title" content="Testing · Palace"/><meta property="twitter:title" content="Testing · Palace"/><meta name="description" content="Documentation for Palace."/><meta property="og:description" content="Documentation for Palace."/><meta property="twitter:description" content="Documentation for Palace."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="Palace logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="Palace logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quick/">Quick Start</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../run/">Running <em>Palace</em></a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../guide/guide/">Overview</a></li><li><a class="tocitem" href="../../guide/problem/">Problem Types</a></li><li><a class="tocitem" href="../../guide/model/">Simulation Models</a></li><li><a class="tocitem" href="../../guide/boundaries/">Boundary Conditions</a></li><li><a class="tocitem" href="../../guide/postprocessing/">Postprocessing and Visualization</a></li><li><a class="tocitem" href="../../guide/parallelism/">Parallelism and GPU Support</a></li></ul></li><li><span class="tocitem">Configuration File</span><ul><li><a class="tocitem" href="../../config/config/">Overview</a></li><li><a class="tocitem" href="../../config/problem/"><code>config[&quot;Problem&quot;]</code></a></li><li><a class="tocitem" href="../../config/model/"><code>config[&quot;Model&quot;]</code></a></li><li><a class="tocitem" href="../../config/domains/"><code>config[&quot;Domains&quot;]</code></a></li><li><a class="tocitem" href="../../config/boundaries/"><code>config[&quot;Boundaries&quot;]</code></a></li><li><a class="tocitem" href="../../config/solver/"><code>config[&quot;Solver&quot;]</code></a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Overview</a></li><li><a class="tocitem" href="../../examples/spheres/">Capacitance Matrix for Two Spheres</a></li><li><a class="tocitem" href="../../examples/rings/">Inductance Matrix for a Pair of Concentric Rings</a></li><li><a class="tocitem" href="../../examples/cylinder/">Eigenmodes of a Cylinder</a></li><li><a class="tocitem" href="../../examples/coaxial/">Signal Propagation in a Coaxial Cable</a></li><li><a class="tocitem" href="../../examples/cpw/">Crosstalk Between Coplanar Waveguides</a></li></ul></li><li><span class="tocitem">For Developers</span><ul><li><a class="tocitem" href="../notes/">Developer Notes</a></li><li class="is-active"><a class="tocitem" href>Testing</a><ul class="internal"><li><a class="tocitem" href="#Building-and-running-unit-tests"><span>Building and running unit tests</span></a></li><li><a class="tocitem" href="#Regression-tests"><span>Regression tests</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">For Developers</a></li><li class="is-active"><a href>Testing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Testing</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/awslabs/palace" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/awslabs/palace/blob/main/docs/src/developer/testing.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><!--- Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved. --->
<!--- SPDX-License-Identifier: Apache-2.0 ---><h1 id="Testing"><a class="docs-heading-anchor" href="#Testing">Testing</a><a id="Testing-1"></a><a class="docs-heading-anchor-permalink" href="#Testing" title="Permalink"></a></h1><p><em>Palace</em> comes with two types of tests:</p><ul><li>Unit tests in <code>test/unit/</code> test individual components in isolation</li><li>Regression tests in <code>test/examples/</code> compare code output against saved references</li></ul><p>Both types of tests are run automatically as part of the project&#39;s continuous integration (CI) workflows.</p><h2 id="Building-and-running-unit-tests"><a class="docs-heading-anchor" href="#Building-and-running-unit-tests">Building and running unit tests</a><a id="Building-and-running-unit-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Building-and-running-unit-tests" title="Permalink"></a></h2><p>The simplest way to build unit tests is using <code>CMake</code>.</p><p>First, follow the <a href="../../install/#Quick-start">quick start</a> to build <em>Palace</em> with <code>CMake</code>. From the <em>Palace</em> root directory:</p><pre><code class="language-bash hljs">mkdir build &amp;&amp; cd build
cmake -DPALACE_MFEM_USE_EXCEPTIONS=yes .. 
make -j palace-tests</code></pre><p>The <code>PALACE_MFEM_USE_EXCEPTIONS</code> option is necessary to properly capture and test assertions.</p><p>Once the build completes, run the tests with:</p><pre><code class="language-bash hljs">palace-build/test/unit/unit-tests</code></pre><p>This runs all the <code>Serial</code> tests. To run <code>Parallel</code> tests, call</p><pre><code class="language-bash hljs">mpirun -np 2 palace-build/test/unit/unit-tests</code></pre><p>To run the <code>GPU</code> tests (this can be combined with <code>mpirun</code>):</p><pre><code class="language-bash hljs">palace-build/test/unit/unit-tests --device cuda</code></pre><p>If you are interested in running only a subset of tests, you can use filters. For example, to run the tests tagged with <code>[vector]</code>, call</p><pre><code class="language-bash hljs">palace-build/test/unit/unit-tests [vector]</code></pre><p>To run a specific test by name:</p><pre><code class="language-bash hljs">palace-build/test/unit/unit-tests &quot;Vector Sum - Real&quot;</code></pre><h4 id="Benchmarks"><a class="docs-heading-anchor" href="#Benchmarks">Benchmarks</a><a id="Benchmarks-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmarks" title="Permalink"></a></h4><p>The unit test application also includes a small number of benchmarks to compare performance between MFEM&#39;s legacy assembly backend, MFEM&#39;s partial assembly backend, and the specified libCEED backend (specified with the <code>--backend</code> option, use <code>-h</code>/<code>--help</code> to list all command line options for the <code>unit-tests</code> executable). These can be run using, for example:</p><pre><code class="language-bash hljs">palace-build/test/unit/unit-tests &quot;[Benchmark]&quot; --benchmark-samples 10</code></pre><p>These benchmarks can be accelerated using MPI and/or OpenMP parallelism (when configured with <code>PALACE_WITH_OPENMP=ON</code>), but in all cases they are only testing the local operator assembly on each process.</p><h3 id="Adding-unit-tests"><a class="docs-heading-anchor" href="#Adding-unit-tests">Adding unit tests</a><a id="Adding-unit-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-unit-tests" title="Permalink"></a></h3><p>Palace uses <a href="https://github.com/catchorg/Catch2">Catch2</a> for unit testing. Refer to the <code>Catch2</code> documentation for detailed usage information. If you have never added a test to <em>Palace</em>, start by reading our <a href="../tutorial_add_new_unit_test/">tutorial on adding a new unit test</a>.</p><p>The most important <code>Catch2</code> feature  in the <em>Palace</em> test suite is <em>tags</em>. When creating a test, you provide a name and a series of tags</p><pre><code class="language-cpp hljs">TEST_CASE(&quot;My name&quot;, &quot;[MyFirstTag][MyOtherTag][Serial]&quot;){ ... }</code></pre><p><code>Catch2</code> tags are typically used for filtering tests. <em>Palace</em> defines three special tags that control when tests execute based on the runtime environment:</p><ul><li><code>[Serial]</code> tests run only with a single MPI process. Use this for tests that verify single-process behavior.</li><li><code>[Parallel]</code> tests run only when multiple MPI processes are available. Use this for tests that verify MPI operations, distributed computations, or inter-process communication.</li><li><code>[GPU]</code> tests run only when GPU devices are available. Use this for tests that are meaningful and interesting on GPU hardware.</li></ul><p>These tags are inclusive, meaning that a test can be marked with multiple special tags, if the test is meaningful in different contexts (e.g., if a test supports CPU and GPU implementation at the same time). For example, <code>[Serial][Parallel][GPU]</code> indicates a test that should run in every case.</p><div class="admonition is-warning" id="Warning-7e925b1188def695"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-7e925b1188def695" title="Permalink"></a></header><div class="admonition-body"><p>Tests without any of our special tags will never execute. Make sure to add at least one.</p></div></div><div class="admonition is-info" id="Tests-should-use-tags-for-which-the-test-is-meaningful-adb5feb23a7d81a3"><header class="admonition-header">Tests should use tags for which the test is meaningful<a class="admonition-anchor" href="#Tests-should-use-tags-for-which-the-test-is-meaningful-adb5feb23a7d81a3" title="Permalink"></a></header><div class="admonition-body"><p>Consider testing this code:</p><pre><code class="language-cpp hljs">int a = 1, b = 2;
Assert(a + b == 3);</code></pre><p>This test will pass if run with MPI, but this is uninteresting since every MPI process executes the same code that the <code>Serial</code> test would run (same with GPUs). Therefore, this test should only be marked as <code>[Serial]</code>.</p></div></div><p>For the other tags, we recommend grouping related tests using descriptive tag names like <code>[vector]</code> or <code>[materialoperator]</code> (typically named after files or classes). This enables effective filtering, as described in <a href="#Building-and-running-unit-tests">Building and running unit tests</a>.</p><h4 id="Test-configuration"><a class="docs-heading-anchor" href="#Test-configuration">Test configuration</a><a id="Test-configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Test-configuration" title="Permalink"></a></h4><p>The <code>CMakeLists.txt</code> in <a href="https://github.com/awslabs/palace/blob/main/test/unit/"><code>test/unit/</code></a> contains important settings:</p><ul><li>The list of files compiled as part of the tests</li><li>The list of files that need to be compiled with a GPU compiler (<code>TARGET_SOURCES_DEVICE</code>)</li><li>Path variables used in tests, such as <code>MFEM_DATA_PATH</code> <code>MFEM_DATA_PATH</code> contains 2D and 3D sample meshes for testing (these meshes come from the <a href="https://github.com/mfem/mfem/tree/master/data">MFEM repository</a>).</li></ul><h2 id="Regression-tests"><a class="docs-heading-anchor" href="#Regression-tests">Regression tests</a><a id="Regression-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Regression-tests" title="Permalink"></a></h2><p>In addition to unit tests, <em>Palace</em> comes with a series of regression tests. Regression tests based on the provided example applications in the <a href="https://github.com/awslabs/palace/blob/main/examples/"><code>examples/</code></a> directory and verify that the code reproduces results in reference files stored in <a href="https://github.com/awslabs/palace/blob/main/test/examples/ref"><code>test/examples/</code></a>.</p><h3 id="Building-and-running-example-tests"><a class="docs-heading-anchor" href="#Building-and-running-example-tests">Building and running example tests</a><a id="Building-and-running-example-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Building-and-running-example-tests" title="Permalink"></a></h3><h4 id="Prerequisites"><a class="docs-heading-anchor" href="#Prerequisites">Prerequisites</a><a id="Prerequisites-1"></a><a class="docs-heading-anchor-permalink" href="#Prerequisites" title="Permalink"></a></h4><ul><li>Julia</li><li>Palace executable in PATH or specified via environment variable</li></ul><h4 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h4><p>First, instantiate the Julia environment:</p><pre><code class="language-bash hljs">julia --project -e &quot;using Pkg; Pkg.instantiate()&quot;</code></pre><p>You need to do this step only the very first time.</p><h4 id="Environment-Variables"><a class="docs-heading-anchor" href="#Environment-Variables">Environment Variables</a><a id="Environment-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#Environment-Variables" title="Permalink"></a></h4><ul><li><code>PALACE_TEST</code>: Path to <em>Palace</em> executable and optional arguments (default: &quot;<code>palace</code>&quot;)</li><li><code>NUM_PROC_TEST</code>: Number of MPI processes (default: number of physical cores)</li><li><code>OMP_NUM_THREADS</code>: Number of OpenMP threads (default: 1)</li><li><code>TEST_CASES</code>: Space-separated list of test cases to run (default: all examples)</li></ul><h4 id="Execution"><a class="docs-heading-anchor" href="#Execution">Execution</a><a id="Execution-1"></a><a class="docs-heading-anchor-permalink" href="#Execution" title="Permalink"></a></h4><p>Run all tests:</p><pre><code class="language-bash hljs">julia --project runtests.jl</code></pre><p>Run specific test cases:</p><pre><code class="language-bash hljs">TEST_CASES=&quot;spheres rings&quot; julia --project runtests.jl</code></pre><p>Run with custom <em>Palace</em> executable:</p><pre><code class="language-bash hljs">PALACE_TEST=&quot;../../build/bin/palace&quot; julia --project runtests.jl</code></pre><p>Run with custom Palace executable and custom MPI launcher:</p><pre><code class="language-bash hljs">PALACE_TEST=&quot;../../build/bin/palace --launcher mpiexec&quot; julia --project runtests.jl</code></pre><p>Each test case runs Palace simulations and compares generated CSV files against reference data using configurable tolerances. When Palace behavior changes legitimately (e.g., algorithm improvements), reference data can be updated using the baseline script:</p><pre><code class="language-bash hljs">./baseline                    # Update all reference data
./baseline -e spheres         # Update specific example
./baseline --dry-run          # Test without updating files
./baseline -np 4              # Use 4 MPI processes</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../notes/">« Developer Notes</a><a class="docs-footer-nextpage" href="../../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 25 September 2025 15:11">Thursday 25 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
