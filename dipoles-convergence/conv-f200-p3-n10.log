Device configuration: cpu
Memory configuration: host-std
libCEED backend: /cpu/self/xsmm/blocked
Filters: [currentdipole] [sphere] [Serial]
Randomness seeded to: 1268873386

Running current dipole test with 1 MPI ranks

Mesh Characteristics:
Dimension          : 3
Space dimension    : 3
Number of vertices : 14401
Number of edges    : 96903
Number of faces    : 161586  --  161586 Triangle(s)
Number of elements : 79083  --  79083 Tetrahedron(s)
Number of bdr elem : 6840  --  6840 Triangle(s)
Euler Number       : 1
h_min              : 0.158238
h_max              : 0.725363
kappa_min          : 1.00726
kappa_max          : 11.5503


Characteristic length and time scales:
 Lc = 1.000e+00 m, tc = 3.336e+00 ns

Configuring electrical current dipole source terms:
 Dipole 1: 
 	Moment = 1.000e+00 AÂ·m
 	Center = (0.000e+00, 0.000e+00, 0.000e+00)
 	Direction = (1.000e+00, 0.000e+00, 0.000e+00)

Configuring Robin absorbing BC (order 2) at attributes:
 1

Assembling system matrices, number of global unknowns:
 H1 (p = 3): 369793, ND (p = 3): 1497474, RT (p = 3): 1918512
 Operator assembly level: Partial
 Mesh geometries:
  Tetrahedron: P = 45, Q = 24 (quadrature order = 6)

Assembling multigrid hierarchy:
 Level 0 (p = 3): 1497474 unknowns
 Level 0 (auxiliary) (p = 3): 369793 unknowns
GMRES solver converged in 526 iterations (avg. reduction factor: 9.571e-01)

Element marking for error computation:
  Domain bounding box: [-5.99998, 6] x [-5.9995, 5.99985] x [-6, 6]
  Domain size: 12 x 11.9994 x 12
  Max distance from origin (sphere radius): 6
  Inner exclusion fraction: 0.1 -> radius: 0.6
  Outer exclusion fraction: 0.95 -> radius: 5.7
  Elements included in error computation: 66274
  Elements excluded (too close to center): 484
  Elements excluded (too close to boundary): 12325
  Total elements: 79083

=== Integration Rule Info ===
  Polynomial order: 3
  Quadrature order: 5
  Using same integration rules for error and norm computation

=== ParaView files written to: ParaView/CurrentDipoleComparison/ ===
=== Use 'element_inclusion_mask' field to see which elements are included in error computation ===

Testing frequency: 2e+08 

Mesh scaling factor (Lc/L0): 1
Test points scaled by: 1
=== Analytical Field Debug at Key Points ===
Origin (scaled) r=0m: r_nondim=0m:
  PALACE FEM SOLUTION:
    Palace |E|: 14350.7
    Palace Ex: (-18.0908,13151.4)
    Palace Ey: (0.00472586,1905.04)
    Palace Ez: (-0.013549,-5418.12)
  ANALYTICAL SOLUTION:
    Analytical |E|: 0
    Analytical Ex: (0,0)
    Analytical Ey: (0,0)
    Analytical Ez: (0,0)
+0.02 origin on x-axis (scaled) r=0.02m: r_nondim=0.02m:
  PALACE FEM SOLUTION:
    Palace |E|: 9848.55
    Palace Ex: (-18.0728,8858.34)
    Palace Ey: (0.00334126,1164.21)
    Palace Ez: (-0.00866863,-4143.43)
  ANALYTICAL SOLUTION:
    Analytical |E|: 92443.6
    Analytical Ex: (-18.0795,-92443.6)
    Analytical Ey: (0,-0)
    Analytical Ez: (0,-0)
  COMPARISON:
    |E| ratio (Palace/Analytical): 0.106536
-0.1 from origin on x-axis (scaled) r=0.1m: r_nondim=0.1m:
  PALACE FEM SOLUTION:
    Palace |E|: 1093.43
    Palace Ex: (-17.7694,-1070.83)
    Palace Ey: (0.00284178,189.385)
    Palace Ez: (-0.00110254,112.818)
  ANALYTICAL SOLUTION:
    Analytical |E|: 799.089
    Analytical Ex: (-17.7763,-798.891)
    Analytical Ey: (0,0)
    Analytical Ez: (0,0)
  COMPARISON:
    |E| ratio (Palace/Analytical): 1.36834
{-.2, .3, .4} from origin (scaled) r=0.538516m: r_nondim=0.538516m:
  PALACE FEM SOLUTION:
    Palace |E|: 11.0818
    Palace Ex: (-4.9653,8.09047)
    Palace Ey: (1.29561,3.19082)
    Palace Ez: (1.72581,4.22584)
  ANALYTICAL SOLUTION:
    Analytical |E|: 11.1208
    Analytical Ex: (-4.96767,8.10742)
    Analytical Ey: (1.30416,3.20532)
    Analytical Ez: (1.73888,4.27376)
  COMPARISON:
    |E| ratio (Palace/Analytical): 0.996494
0.2 field on y-axis (scaled) r=0.2m: r_nondim=0.2m:
  PALACE FEM SOLUTION:
    Palace |E|: 620.511
    Palace Ex: (-15.6388,-511.624)
    Palace Ey: (-0.00255288,-320.632)
    Palace Ez: (-0.00296689,-142.217)
  ANALYTICAL SOLUTION:
    Analytical |E|: 40.9686
    Analytical Ex: (-15.6433,37.8644)
    Analytical Ey: (0,-0)
    Analytical Ez: (0,-0)
  COMPARISON:
    |E| ratio (Palace/Analytical): 15.146
-0.3 field on z-axis (scaled) r=0.3m: r_nondim=0.3m:
  PALACE FEM SOLUTION:
    Palace |E|: 17.9411
    Palace Ex: (-12.829,12.4259)
    Palace Ey: (0.00165072,0.53011)
    Palace Ez: (0.0134446,-1.61741)
  ANALYTICAL SOLUTION:
    Analytical |E|: 18.9069
    Analytical Ex: (-12.8365,13.8814)
    Analytical Ey: (0,-0)
    Analytical Ez: (0,0)
  COMPARISON:
    |E| ratio (Palace/Analytical): 0.94892
0.4 field on x-axis (scaled) r=0.4m: r_nondim=0.4m:
  PALACE FEM SOLUTION:
    Palace |E|: 21.9407
    Palace Ex: (-13.4774,-17.242)
    Palace Ey: (-0.00435494,0.150205)
    Palace Ez: (0.007609,-1.56374)
  ANALYTICAL SOLUTION:
    Analytical |E|: 22.4802
    Analytical Ex: (-13.491,-17.982)
    Analytical Ey: (-0,0)
    Analytical Ez: (-0,0)
  COMPARISON:
    |E| ratio (Palace/Analytical): 0.976003
+0.45 on y-axis (scaled) r=0.45m: r_nondim=0.45m:
  PALACE FEM SOLUTION:
    Palace |E|: 12.9112
    Palace Ex: (-7.46394,10.3633)
    Palace Ey: (-0.00495848,1.54256)
    Palace Ez: (-0.00339179,1.09995)
  ANALYTICAL SOLUTION:
    Analytical |E|: 12.8519
    Analytical Ex: (-7.46678,10.4603)
    Analytical Ey: (0,-0)
    Analytical Ez: (0,-0)
  COMPARISON:
    |E| ratio (Palace/Analytical): 1.00461
+0.47 on z-axis (scaled) r=0.47m: r_nondim=0.47m:
  PALACE FEM SOLUTION:
    Palace |E|: 12.5889
    Palace Ex: (-6.69436,10.6377)
    Palace Ey: (-0.0037383,-0.0123155)
    Palace Ez: (-0.00882769,-0.710594)
  ANALYTICAL SOLUTION:
    Analytical |E|: 12.388
    Analytical Ex: (-6.70324,10.4177)
    Analytical Ey: (0,-0)
    Analytical Ez: (0,-0)
  COMPARISON:
    |E| ratio (Palace/Analytical): 1.01622
+0.495 from origin on x-axis (scaled) r=0.495m: r_nondim=0.495m:
  PALACE FEM SOLUTION:
    Palace |E|: 13.8759
    Palace Ex: (-11.3954,-7.90447)
    Palace Ey: (-0.0031346,-0.218124)
    Palace Ez: (0.0161957,0.395271)
  ANALYTICAL SOLUTION:
    Analytical |E|: 13.9952
    Analytical Ex: (-11.4099,-8.10434)
    Analytical Ey: (0,-0)
    Analytical Ez: (0,-0)
  COMPARISON:
    |E| ratio (Palace/Analytical): 0.991472
-0.5 from origin on z-axis (scaled) r=0.5m: r_nondim=0.5m:
  PALACE FEM SOLUTION:
    Palace |E|: 11.8287
    Palace Ex: (-5.56025,10.4398)
    Palace Ey: (0.00593785,-0.0889162)
    Palace Ez: (0.0131301,0.0696204)
  ANALYTICAL SOLUTION:
    Analytical |E|: 11.7553
    Analytical Ex: (-5.55681,10.359)
    Analytical Ey: (0,-0)
    Analytical Ez: (0,0)
  COMPARISON:
    |E| ratio (Palace/Analytical): 1.00625
============================================


=== L2 ERROR ANALYSIS ===Polynomial order 3


--- E-FIELD: Selective Elements (0.2-0.8 domain) ---
Absolute L2 Errors:
  Real part error: || E_h_Re - E_Re ||_L2 = 0.252334
  Imag part error: || E_h_Im - E_Im ||_L2 = 0.259215
  Total error:     || E_h - E ||_L2 = 0.361752
Exact Solution Norms:
  Real part norm: || E_Re ||_L2 = 30.2363
  Imag part norm: || E_Im ||_L2 = 30.1291
  Total norm:     || E ||_L2 = 42.6849
Relative L2 Errors:
  Real part: || E_h_Re - E_Re || / ||E_Re|| = 0.00834538
  Imag part: || E_h_Im - E_Im || / ||E_Im|| = 0.00860345
  Total:     || E_h - E || / ||E|| = 0.00847494

--- E-FIELD: Full Domain (for comparison) ---
Absolute L2 Errors:
  Real part error: || E_h_Re - E_Re ||_L2 = 0.273617
  Imag part error: || E_h_Im - E_Im ||_L2 = 256.71
  Total error:     || E_h - E ||_L2 = 256.71
Exact Solution Norms:
  Real part norm: || E_Re ||_L2 = 32.395
  Imag part norm: || E_Im ||_L2 = 143.85
  Total norm:     || E ||_L2 = 147.453
Relative L2 Errors:
  Real part: || E_h_Re - E_Re || / ||E_Re|| = 0.00844629
  Imag part: || E_h_Im - E_Im || / ||E_Im|| = 1.78456
  Total:     || E_h - E || / ||E|| = 1.74096

--- E-FIELD: Error Comparison ---
Selective vs Full Domain Error Ratios:
  Selective/Full Error Ratio: 0.00140918
  Selective/Full Relative Error Ratio: 0.00486796

--- B-FIELD: Selective Elements (0.2-0.8 domain) ---
Absolute L2 Errors:
  Real part error: || B_h_Re - B_Re ||_L2 = 0.305939
  Imag part error: || B_h_Im - B_Im ||_L2 = 0.29178
  Total error:     || B_h - B ||_L2 = 0.42277
Exact Solution Norms:
  Real part norm: || B_Re ||_L2 = 29.9909
  Imag part norm: || B_Im ||_L2 = 30.282
  Total norm:     || B ||_L2 = 42.6199
Relative L2 Errors:
  Real part: || B_h_Re - B_Re || / ||B_Re|| = 0.0102011
  Imag part: || B_h_Im - B_Im || / ||B_Im|| = 0.00963542
  Total:     || B_h - B || / ||B|| = 0.00991954

--- B-FIELD: Full Domain (for comparison) ---
Absolute L2 Errors:
  Real part error: || B_h_Re - B_Re ||_L2 = 23.8881
  Imag part error: || B_h_Im - B_Im ||_L2 = 0.327513
  Total error:     || B_h - B ||_L2 = 23.8904
Exact Solution Norms:
  Real part norm: || B_Re ||_L2 = 40.499
  Imag part norm: || B_Im ||_L2 = 32.4686
  Total norm:     || B ||_L2 = 51.9074
Relative L2 Errors:
  Real part: || B_h_Re - B_Re || / ||B_Re|| = 0.589845
  Imag part: || B_h_Im - B_Im || / ||B_Im|| = 0.0100871
  Total:     || B_h - B || / ||B|| = 0.460249

--- B-FIELD: Error Comparison ---
Selective vs Full Domain Error Ratios:
  Selective/Full Error Ratio: 0.0176962
  Selective/Full Relative Error Ratio: 0.0215525

===============================================================================
All tests passed (3 assertions in 1 test case)

